<div class="requests-page">

  <h2>Incoming Session Requests</h2>

  <!-- Loading -->
  <div *ngIf="requests === null" class="loading">
    Loading requests...
  </div>

  <!-- Empty -->
  <div *ngIf="requests !== null && requests.length === 0"
       class="empty">
    No session requests yet.
  </div>

  <!-- Cards -->
  <div class="request-grid"
       *ngIf="requests !== null && requests.length > 0">

    <div class="request-card"
         *ngFor="let r of requests">

      <!-- Header -->
      <div class="card-header">
        <div>
          <h3>{{ r.skill.name }}</h3>
          <p class="learner">
            Learner: {{ r.learner.name }}
          </p>
        </div>

        <span class="status"
              [ngClass]="r.status">
          {{ r.status }}
        </span>
      </div>

      <!-- Rating -->
      <div *ngIf="r.rating" class="review">
        <div class="stars">
          <span *ngFor="let star of getStars(r.rating)">â˜…</span>
        </div>
        <p>{{ r.review }}</p>
      </div>

      <!-- Actions -->
      <div class="actions">

        <!-- Pending -->
        <ng-container *ngIf="r.status === 'pending'">
          <button
            class="btn accept"
            (click)="updateStatus(r._id, 'accepted')">
            Accept
          </button>

          <button
            class="btn reject"
            (click)="updateStatus(r._id, 'rejected')">
            Reject
          </button>
        </ng-container>

        <!-- Accepted -->
        <ng-container *ngIf="r.status === 'accepted'">
          <button
            class="btn complete"
            (click)="markCompleted(r._id)">
            Mark Completed
          </button>

          <a
            class="btn chat"
            [routerLink]="['/chat', r._id]">
            Open Chat
          </a>
        </ng-container>

      </div>

    </div>

  </div>

</div>
