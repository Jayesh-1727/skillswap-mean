<h2>My Session Requests</h2>

<div *ngIf="requests === null">
  <p>Loading...</p>
</div>

<div *ngIf="requests !== null && requests.length === 0">
  <p>You have not sent any requests yet.</p>
</div>

<div *ngIf="requests !== null">
  <div *ngFor="let r of requests">
  <hr />
  <p><strong>Teacher:</strong> {{ r.teacher.name }}</p>
  <p><strong>Skill:</strong> {{ r.skill.name }}</p>
  <p><strong>Status:</strong> {{ r.status }}</p>

  <!-- Show feedback form only if completed and not rated -->
  <div *ngIf="r.status === 'completed' && !r.rating">
    <label>Rating (1–5):</label>
    <input #rating type="number" min="1" max="5" />

    <label>Review:</label>
    <input #review type="text" />

    <button
      type="button"
      (click)="submitFeedback(r._id, +rating.value, review.value)">
      Submit Feedback
    </button>
  </div>

  <!-- Show existing rating -->
  <div *ngIf="r.rating">
    <p>⭐ You rated: {{ r.rating }}</p>
    <p>Review: {{ r.review }}</p>
  </div>
</div>

</div>
